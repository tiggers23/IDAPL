# Rethinking the Effect of Uninformative Class Name in Prompt Learning
This repo contains the code for the IDAPL research project, which focuses on investigating the effect of uninformative classname in prompt Learning. This code is based on the [CoOp](https://github.com/KaiyangZhou/CoOp) implementation.
# How to install
This code is built on top of the toolbox [Dassl.pytorch](https://github.com/KaiyangZhou/Dassl.pytorch). so you need to install the dassl environment first. All installation details for the environment can refer to [CoOp](https://github.com/KaiyangZhou/Dassl.pytorch#installation).
Follow [DATASETS](https://github.com/KaiyangZhou/CoOp/blob/main/DATASETS.md) to install the datasets.
And if you want to use the description generated by [gpt4_data](https://github.com/mayug/VDT-Adapter/tree/acece943215deb73545bfa3d005e5de5f5cfec9b/gpt4_data) to standardize the direction of prompt learning, please thank and download the data support provided by [CLIP-A-Self](https://github.com/mayug/VDT-Adapter/tree/main).
# Few-shot setting on 11 datasets.
## How to run!
We have chosen hyperparameters 0.1 and 5.0 for the weights of learnable class vectors and classification loss weights, but they are generally robust in most cases, You can choose based on your downstream tasks. 
**However,please note that learnable class vectors are only used for base classes**.
```Bash
bash scripts/coop_idapl/main.sh ${DATSET_NAME} ${CFG} ${SHOTS} ${N_CTX} **${ASSOCIATIVE_LEARNING}** ${SCORE_LC} ${SCORE_CLF}
```
### For example:
When training base classes, please remember to set the **ASSOCIATIVE_LEARNING** to **True**
```Bash
CUDA_VISIBLE_DEVICES=0 bash scripts/coop_idapl/main.sh stanford_cars vit_b16_ep50_ctxv1 16 16 True 0.1 5.0
```
## How to test!
```Bash
bash scripts/coop_idapl/eval.sh ${DATSET_NAME} ${CFG} ${SHOTS} ${N_CTX} **${ASSOCIATIVE_LEARNING}** ${SCORE_LC} ${SCORE_CLF} ${SUB}
```
### For example:
When testing basic classes, choose **True** and **base**;
```Bash
CUDA_VISIBLE_DEVICES=0 bash scripts/coop_idapl/eval.sh stanford_cars vit_b16_ep50_ctxv1 16 16 True 0.1 5.0 base
```
When testing novel classes, only contextual prompts are used, so choose **False** and **new**
```Bash
CUDA_VISIBLE_DEVICES=0 bash scripts/coop_idapl/eval.sh stanford_cars vit_b16_ep50_ctxv1 16 16 False 0.1 5.0 new
```
